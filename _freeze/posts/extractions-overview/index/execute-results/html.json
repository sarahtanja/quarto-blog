{
  "hash": "318107d081a8807d1dc17f0e6c477670",
  "result": {
    "markdown": "---\ntitle: \"DNA/RNA Extractions Overview\"\nauthor: \"Sarah Tanja\"\ndate: '05/23/2023'\ncategories: [lab records]\ndraft: false\ntoc: true\ntoc-exand: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nextr_meta <- read_csv(\"output/extractions_metadata.csv\")\nhead(extr_meta)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 19\n  cryo_id colony pae_treatment temp_treatment tank  cryo_rep pae_ugL freeze_date\n  <chr>    <dbl> <chr>         <chr>          <chr> <chr>    <chr>   <chr>      \n1 1-Ea         1 environmental kbay           na    a        na      8/5/2022   \n2 1-Eb         1 environmental kbay           na    b        na      8/5/2022   \n3 2-Ea         2 environmental kbay           na    a        na      8/5/2022   \n4 2-Eb         2 environmental kbay           na    b        na      8/5/2022   \n5 3-Ea         3 environmental kbay           na    a        na      8/5/2022   \n6 3-Eb         3 environmental kbay           na    b        na      8/5/2022   \n# ℹ 11 more variables: cull_notes <chr>, extraction_id <dbl>, extr_date <chr>,\n#   qubit_rna_run_date <chr>, qubit_rna_1 <dbl>, qubit_rna_2 <dbl>,\n#   qubit_rna_3 <dbl>, qubit_dna_run_date <chr>, qubit_dna_1 <dbl>,\n#   qubit_dna_2 <dbl>, qubit_dna_3 <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nextracted <- extr_meta %>%\n  filter(!is.na(extraction_id))\nhead(extracted, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 19\n   cryo_id colony pae_treatment temp_treatment tank  cryo_rep pae_ugL\n   <chr>    <dbl> <chr>         <chr>          <chr> <chr>    <chr>  \n 1 1-Ea         1 environmental kbay           na    a        na     \n 2 2-Ea         2 environmental kbay           na    a        na     \n 3 3-Ea         3 environmental kbay           na    a        na     \n 4 4-Ea         4 environmental kbay           na    a        na     \n 5 1-CA2a       1 control       ambient        A2    a        0      \n 6 1-CH2a       1 control       hot            H2    a        0      \n 7 1-PA2a       1 peak          ambient        A2    a        150    \n 8 1-PH1a       1 peak          hot            H1    a        150    \n 9 2-CA2a       2 control       ambient        A2    a        0      \n10 2-CH1a       2 control       hot            H1    a        0      \n11 2-PA1a       2 peak          ambient        A1    a        150    \n12 2-PH2a       2 peak          hot            H2    a        150    \n13 3-CA1a       3 control       ambient        A1    a        0      \n14 3-CH2a       3 control       hot            H2    a        0      \n15 3-PA1a       3 peak          ambient        A1    a        150    \n16 3-PH1a       3 peak          hot            H1    a        150    \n17 4-CA1a       4 control       ambient        A1    a        0      \n18 4-CH1a       4 control       hot            H1    a        0      \n19 4-PA2a       4 peak          ambient        A2    a        150    \n20 4-PH1a       4 peak          hot            H1    a        150    \n# ℹ 12 more variables: freeze_date <chr>, cull_notes <chr>,\n#   extraction_id <dbl>, extr_date <chr>, qubit_rna_run_date <chr>,\n#   qubit_rna_1 <dbl>, qubit_rna_2 <dbl>, qubit_rna_3 <dbl>,\n#   qubit_dna_run_date <chr>, qubit_dna_1 <dbl>, qubit_dna_2 <dbl>,\n#   qubit_dna_3 <dbl>\n```\n:::\n:::\n\n\nQubit RNA BR Assay Kit The Qubit RNA BR (Broad-Range) Assay Kit, when used with the Qubit Fluorometer, provides an accurate and selective method for the quantitation of RNA samples. Depending on sample volume, the assay kit is designed to be accurate for initial RNA sample concentrations of 0.5 to 1,200 ng/µL, providing a detection range of 10−1,200 ng.\n\n\\*\\* IF RNA QUBIT IS ENTERED AS 1,201 IT WAS TOO HIGH!\\*\\*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Make RNA average column and move to after 3rd reading `qubit_rna_3`\nextracted <- extracted %>% \n  mutate(\n    qubit_rna_avg = rowMeans(select(.,qubit_rna_1, qubit_rna_2, qubit_rna_3))) %>%\n    relocate(qubit_rna_avg, .after = qubit_rna_3) \n\n# Make DNA average column and move to after 3rd reading `qubit_dna_3`\nextracted <- extracted %>% \n  mutate(   \n    qubit_dna_avg = rowMeans(select(.,qubit_dna_1, qubit_dna_2, qubit_dna_3))) %>%\n    relocate(qubit_dna_avg, .after = qubit_dna_3)\n\n# Make a slimmed-down version \ncolumns <- c(\"cryo_id\", \"extraction_id\", \"qubit_rna_avg\", \"qubit_dna_avg\")\n\nextracted_slim <- extracted %>% \n  select(all_of(columns))\n\n# Save this as a running list of extracted samples\nwrite_csv(extracted, \"output/extracted.csv\")\nwrite_csv(extracted_slim, \"output/extracted_slim.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset to review Qubit Scores\nqubit_scores <- extracted  %>%\n  select(cryo_id, extraction_id, qubit_dna_avg, qubit_rna_avg) %>% \n  arrange(extraction_id)\n\nprint(qubit_scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 4\n   cryo_id extraction_id qubit_dna_avg qubit_rna_avg\n   <chr>           <dbl>         <dbl>         <dbl>\n 1 3-Ea                1         38.8            0  \n 2 3-CA1a              1         74.1           12.9\n 3 2-CH1a              2          0             20.8\n 4 2-PH2a              2         58.5           77.1\n 5 1-CA2a              3        371.            96.8\n 6 1-CH2a              3        193.            37.1\n 7 3-PA1a              3        396            102. \n 8 3-PH1a              3          3.23          43.4\n 9 1-Ea                4        199             52.7\n10 2-PA1a              4          6.3          153. \n11 1-PA2a              5        347.           760  \n12 1-PH1a              5        435.           812  \n13 3-CH2a              5        276           1201  \n14 4-CA1a              5        287.          1201  \n15 4-PA2a              5        577.           728  \n16 4-PH1a              5         16.4           43.7\n17 2-Ea                6        240            447. \n18 4-Ea                6        205.           239. \n19 2-CA2a              6        391.           319. \n20 4-CH1a              6        311.            83.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create base scatterplot\nrna <- ggplot(data = extracted, aes(x = extraction_id, y = qubit_rna_avg, color = cryo_id)) +\n  geom_point(size = 2, shape = 1) + \n  ylab(\"RNA Quantity in ug/uL\") + \n  geom_hline(yintercept = 20, linetype = \"solid\", color = \"red\")\n\n# save the plot as an PNG file\nggsave(\"../output/rna.png\", plot = rna, width = 8, height = 4, dpi = 600)\n\n# View plot\nrna\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndna <- ggplot(data = extracted, aes(x = extraction_id, y = qubit_dna_avg, color = cryo_id)) +\n  geom_point(size = 2, shape = 3) + \n  ylab(\"DNA Quantity in ug/uL\") + \n  geom_hline(yintercept = 20, linetype = \"solid\", color = \"red\")\n\n# save the plot as an PNG file\nggsave(\"../output/dna.png\", plot = dna, width = 8, height = 4, dpi = 600)\n\n# View plot\ndna\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrna_dna <- rna +\n  geom_point(data = extracted, aes(x = extraction_id, y = qubit_dna_avg, color = cryo_id), size = 2, shape = 3) +\n  scale_shape_manual(name = \"Nucleotides\", values = c(0, 2), labels = c(\"RNA\", \"DNA\")) +\n  ylab(\"Nucleotide Quantity in ug/uL\") + \n  xlab(\"Extraction Batch\")\n\n# save the plot as an PNG file\nggsave(\"output/rna_dna.png\", plot = rna_dna, width = 8, height = 4, dpi = 600)\n\n# View plot\nrna_dna\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## Wilcoxon Paired-Sample T Test\n\n::: {.cell}\n\n```{.r .cell-code}\nqubit_scores$diff <- qubit_scores$qubit_dna_avg - qubit_scores$qubit_rna_avg\nhist(qubit_scores$diff)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(qubit_scores$diff)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(qubit_scores$diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  qubit_scores$diff\nW = 0.84347, p-value = 0.004152\n```\n:::\n:::\n\nThe differences are not normally distributed, (p < 0.05), therefore we cannot use a paired-sample t test. If the data do not meet the assumptions of normality required for parametric tests like the paired t-test, but you want to determine if there is a trend between two paired samples, you can use the Wilcoxon paired-sample T test. This is a non-parametric statistical test used to compare two related samples or repeated measures. It is appropriate for this dataset, because each row of DNA and RNA were extracted from the same sample. Here we really want to know if our Dual extraction method is biased toward optimizing yield for DNA or RNA, or if there is any trend at all.\n> Our null and alternate hypotheses are:\nH0: There is no trend between the paired samples.\nH1: There is a trend between the paired samples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(x=qubit_scores$qubit_dna_avg, y=qubit_scores$qubit_rna_avg, paired=TRUE, alternative = 'two.sided')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  qubit_scores$qubit_dna_avg and qubit_scores$qubit_rna_avg\nV = 86, p-value = 0.498\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\nThe Wilcoxon signed-rank test, as a non-parametric test, determines whether there is a shift or trend in the paired observations but does not provide information about the direction or magnitude of the shift. It only tells you that there is a significant difference between the paired samples, but it does not indicate which sample has higher values or the direction of the shift.\n\nTo determine the direction of the shift, you would need to examine the data and calculate the median or mean of the paired differences. If the median or mean of the differences is positive, it suggests that the second sample tends to have higher values than the first sample. Conversely, if the median or mean is negative, it indicates that the first sample tends to have higher values than the second sample.\n\nTo get a better understanding of the direction and magnitude of the shift, you may consider plotting the paired differences or constructing a confidence interval around the median or mean difference. This can provide additional insights into the nature of the shift and help you interpret the results more accurately.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}