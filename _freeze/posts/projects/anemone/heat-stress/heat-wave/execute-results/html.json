{
  "hash": "4201f8de40b14e8847e86a9ae9bb3c7c",
  "result": {
    "markdown": "---\ntitle: \"Environmental Landscape of an Intertidal Heat Wave\"\nsubtitle: \"Using NOAA National Data Buoy Center (NDBC) to map air and water temperatures in Commencement Bay, Tacoma, WA, during the June 2021 Puget Sound heat wave\"\nauthor: \"Sarah Tanja\"\ndate: \"07 July, 2024\" \nbibliography: heat.bib\ncitation: true\ncitation-location: margin\nformat:\n  html:\n    df-print: paged\n    toc: true\n    toc-location: right\n    smooth-scroll: true\n    link-external-icon: true\n    link-external-newwindow: true\n    code-fold: false\n    code-tools: true\n    code-copy: true\n    highlight-style: breeze\n    code-overflow: wrap\n    theme: minty\n---\n\n\n\n\nI searched the NDBC map for the stations closest to my collection site at Owens Beach, Point Defiance Park in Commencement Bay, Tacoma.\n\nI found the following stations:\n\nStation TCMW1 9446482 Tacoma, Met, WA - air temp\n\n::: column-margin\n![TCMW1: air temp](images/NDBC-TCMW1.jpg)\n:::\n\nHistorical data: <https://www.ndbc.noaa.gov/station_history.php?station=tcmw1>\n\n\n[Station TCNW1](https://tidesandcurrents.noaa.gov/stationhome.html?id=9446484) 9446484 Tacoma, WA - water temp - tide height\n\n::: column-margin\n![TCNW1 - water temp, tide height](images/NDCB-TCNW1.jpg)\n:::\n\nHistorical Data: <https://www.ndbc.noaa.gov/station_history.php?station=tcnw1>\n\n## Install Packages\n\n\n::: {.cell layout-align=\"center\" hash='heat-wave_cache/html/install-packages_f16c9afb9c0db82db5d3d813762114a9'}\n\n```{.r .cell-code}\nif (\"tidyverse\" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')\nif (\"plotly\" %in% rownames(installed.packages()) == 'FALSE') install.packages('plotly')\n```\n:::\n\n\n## Load packages\n\n\n::: {.cell layout-align=\"center\" hash='heat-wave_cache/html/load-packages_a77f5330a7af652c474436169aae2ee0'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(plotly)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.bash .cell-code}\n# make a data directory, if there isn't one already (-p option will make one only if it isn't already there, otherwise it will do nothing)\nmkdir -p data\n```\n:::\n\n\n## Use `curl` to get NDBC data\n\nPull data from the year 2021 in which the June record-breaking heat wave occurred...\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.bash .cell-code}\n# navigate to data directory\ncd data\n\n# download 2021 data from station TCNW1 NDBC into the data directory\n# this station has water temp in F\ncurl -O https://www.ndbc.noaa.gov/data/historical/stdmet/tcnw1h2021.txt.gz \n\n# download 2021 data from station TCMW1 NDBC into the data directory\n# this station has air temp in F\ncurl -O https://www.ndbc.noaa.gov/data/historical/stdmet/tcmw1h2021.txt.gz\n\n```\n:::\n\n## `gunzip` data files\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.bash .cell-code}\n\ngunzip data/tcnw1h2021.txt.gz \n\ngunzip data/tcmw1h2021.txt.gz\n\n```\n:::\n\n\n## Read data into R and look at it!\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nread_tsv\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Read the first two rows separately to get column names\ncolumn_names <- read_table(\"data/tcnw1h2021.txt\", n_max = 2, col_names = FALSE)\n\n# Use the first row as column names\ncolumn_names <- column_names[1, ]\n\n# read in data but skip the first two rows\ntcnw12021 <- read_table(\"data/tcnw1h2021.txt\", col_names = FALSE, skip = 2)\n\n# Set column names\ncolnames(tcnw12021) <- column_names\n\n# Print the first few rows of the data\nprint(tcnw12021)\n```\n:::\n\nMake the UTC timestamp work\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Concatenate into datetime stamp (these are UTC)\ntcnw12021$datetimeUTC <- as.POSIXct(paste(tcnw12021$`#YY`, tcnw12021$MM, tcnw12021$DD, tcnw12021$hh, tcnw12021$mm),\n                        format=\"%Y %m %d %H %M\")\n```\n:::\n\n\nGet rid of NA data.. which appears to show up as 999\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntemps_subset <- tcnw12021 %>% \n  select(ATMP, WTMP, datetimeUTC)\n\ntemps_subset <- temps_subset %>% \n   mutate_all(~ replace(., . == 999, NA))\n```\n:::\n\n\n\nGraph air and water temps with datetimeUTC on X axis and air(ATMP) & water(WTMP) temp on Y axis\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntemps <- ggplot(na.omit(temps_subset), aes(x = datetimeUTC, y = WTMP)) +\n  geom_point()+\n  theme_bw()\n\nggplotly(temps)\n```\n:::\n\n\nSeriously!? The station data cuts out in May!?\n\nWhat's the next closest station that has June data?\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}