<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sarah Tanja">
<meta name="dcterms.date" content="2024-07-09">

<title>Bench Incubation – Sarah Tanja’s Open Lab Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta property="og:title" content="Bench Incubation – Sarah Tanja’s Open Lab Notebook">
<meta property="og:description" content="Lab bench records and environmental logs for the development of Montipora capitata embryos exposed to PVC leachate">
<meta property="og:site_name" content="Sarah Tanja's Open Lab Notebook">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="linktree.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../images/favicon.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="linktree.html">
    <span class="navbar-title">Sarah Tanja’s Open Lab Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../learning.qmd"> 
<span class="menu-text">Learning</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/sarah-tanja-595722146/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/sarahtanja">
 <span class="dropdown-text">Sarah’s GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sarahtanja/coral-embryo-leachate">
 <span class="dropdown-text">Coral Embryology Project Repository</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sarahtanja/coral-leachate-heat">
 <span class="dropdown-text">Coral Photophysiology Project Repository</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sarahtanja/anemone-leachate-heat">
 <span class="dropdown-text">Anemone Photophysiology Project Repository</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/sarahtanja/coral-pae-temp">
 <span class="dropdown-text">Coral Microbiome Project Repository</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-envelope-paper" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-envelope-paper" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-envelope-paper">    
        <li class="dropdown-header">stanja@uw.edu</li>
        <li>
    <a class="dropdown-item" href="../../../../contact.html">
 <span class="dropdown-text">Contact</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Bench Incubation</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
            <p class="subtitle lead">Lab bench records and environmental logs for the development of <em>Montipora capitata</em> embryos exposed to PVC leachate</p>
                                <div class="quarto-categories">
                <div class="quarto-category">protocols</div>
                <div class="quarto-category">records</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Sarah Tanja </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 9, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">October 23, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Contents <i class="bi bi-bookmark-heart"></i></h2>
   
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
  <li><a href="#inputs" id="toc-inputs" class="nav-link" data-scroll-target="#inputs"><span class="header-section-number">1.1</span> Inputs</a></li>
  <li><a href="#outputs" id="toc-outputs" class="nav-link" data-scroll-target="#outputs"><span class="header-section-number">1.2</span> Outputs</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">2</span> Setup</a>
  <ul class="collapse">
  <li><a href="#install-packages" id="toc-install-packages" class="nav-link" data-scroll-target="#install-packages"><span class="header-section-number">2.1</span> Install packages</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="header-section-number">2.2</span> Load packages</a></li>
  <li><a href="#load-hobo-logs" id="toc-load-hobo-logs" class="nav-link" data-scroll-target="#load-hobo-logs"><span class="header-section-number">2.3</span> Load HOBO logs</a></li>
  </ul></li>
  <li><a href="#format-hobo-logs" id="toc-format-hobo-logs" class="nav-link" data-scroll-target="#format-hobo-logs"><span class="header-section-number">3</span> Format HOBO logs</a></li>
  <li><a href="#plot-overlapping-logs" id="toc-plot-overlapping-logs" class="nav-link" data-scroll-target="#plot-overlapping-logs"><span class="header-section-number">4</span> Plot overlapping logs</a></li>
  <li><a href="#averages" id="toc-averages" class="nav-link" data-scroll-target="#averages"><span class="header-section-number">5</span> Averages</a></li>
  <li><a href="#hyopthesis-testing" id="toc-hyopthesis-testing" class="nav-link" data-scroll-target="#hyopthesis-testing"><span class="header-section-number">6</span> Hyopthesis testing</a>
  <ul class="collapse">
  <li><a href="#is-temp-different-across-location" id="toc-is-temp-different-across-location" class="nav-link" data-scroll-target="#is-temp-different-across-location"><span class="header-section-number">6.1</span> Is temp different across location?</a></li>
  <li><a href="#is-temp-different-across-space" id="toc-is-temp-different-across-space" class="nav-link" data-scroll-target="#is-temp-different-across-space"><span class="header-section-number">6.2</span> Is temp different across space?</a></li>
  <li><a href="#is-lab-temp-different-across-stage" id="toc-is-lab-temp-different-across-stage" class="nav-link" data-scroll-target="#is-lab-temp-different-across-stage"><span class="header-section-number">6.3</span> Is lab temp different across stage?</a></li>
  <li><a href="#is-lab-temp-different-across-spawn-night" id="toc-is-lab-temp-different-across-spawn-night" class="nav-link" data-scroll-target="#is-lab-temp-different-across-spawn-night"><span class="header-section-number">6.4</span> Is lab temp different across spawn night?</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">7</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="background" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Background</h1>
<p>On July 5th, 6th, and 7th 2024 we conducted an ecotox assay on the development of <em>Montipora capitata</em> coral embryo development under exposure to PVC leachate at nominal concentrations of 0 mg/L (0.22um FSW, control), 0.01 mg/L (low), 0.1 mg/L (mid), and 1 mg/L (high). We repeated our assay across three nights of spawning. In the assay, embryos were incubated in 20mL scintillation vials in a climate-controlled lab. Here we detail the conditions of the incubation period.</p>
<p>We left a HOBO logger out on the lab bench, in the lab hood, and in an ambient flow through holding tank where adult coral colonies were being kept. We will compare the data here.</p>
<section id="inputs" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="inputs"><span class="header-section-number">1.1</span> Inputs</h2>
<ul>
<li>HOBO data logs</li>
</ul>
</section>
<section id="outputs" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="outputs"><span class="header-section-number">1.2</span> Outputs</h2>
<ul>
<li>Visualizations comparing the lab bench conditions to the ambient seawater at HIMB around the July <em>Montipora capitata</em> spawning event in 2024.</li>
</ul>
</section>
</section>
<section id="setup" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setup</h1>
<section id="install-packages" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="install-packages"><span class="header-section-number">2.1</span> Install packages</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"tidyverse"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'tidyverse'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"reshape2"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'reshape2'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"plotly"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'plotly'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"car"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'car'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"agricolae"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'agricolae'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"hms"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="sc">==</span> <span class="st">'FALSE'</span>) <span class="fu">install.packages</span>(<span class="st">'hms'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-packages" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">2.2</span> Load packages</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># for Levene's test </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae) <span class="co"># for post-hoc tests</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-hobo-logs" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="load-hobo-logs"><span class="header-section-number">2.3</span> Load HOBO logs</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"embryo-inc-bench 2024-07-08 13_34_32 HST (Data HST).csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>hood <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"embryo-inc-hood 2024-07-08 13_35_01 HST (Data HST).csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>tank1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Holding tank  2024-07-03 15_30_47 HST (Data HST).csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>tank2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Holding tank  2024-07-08 08_32_55 HST (Data HST).csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>tank3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"AmbientTemp2 2024-07-08 08_32_20 HST (Data HST).csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="format-hobo-logs" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Format HOBO logs</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> bench <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"bench"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>hood <span class="ot">&lt;-</span> hood <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"hood"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>tank1 <span class="ot">&lt;-</span> tank1 <span class="sc">%&gt;%</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>tank2 <span class="ot">&lt;-</span> tank2 <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>tank3 <span class="ot">&lt;-</span> tank3 <span class="sc">%&gt;%</span> </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(bench, hood, tank1, tank2, tank3)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>all<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(all<span class="sc">$</span>datetime, <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-overlapping-logs" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Plot overlapping logs</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> <span class="fu">melt</span>(all, <span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">"datetime"</span>, <span class="st">"location"</span>), <span class="at">measure.vars=</span><span class="fu">c</span>(<span class="st">"temp"</span>, <span class="st">"lux"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The incubation windows were:</p>
<p>1- July 5th 21:20 - July 6th 13:30</p>
<p>2 - July 6th 21:20 - July 7th 13:30</p>
<p>3- July 7th 21:20 - July 8th 13:30</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>incubation_windows <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">"07/05/2024 21:20:00"</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"07/06/2024 21:20:00"</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"07/07/2024 21:20:00"</span>), </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">end =</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">"07/06/2024 13:30:00"</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"07/07/2024 13:30:00"</span>, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"07/08/2024 13:30:00"</span>), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate scaling factor for the secondary (lux) axis</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lux_scale <span class="ot">&lt;-</span> <span class="fu">max</span>(all<span class="sc">$</span>temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">max</span>(all<span class="sc">$</span>lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all, <span class="fu">aes</span>(<span class="at">x =</span> datetime)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight windows</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> incubation_windows,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xmin =</span> start, <span class="at">xmax =</span> end),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot temp</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> temp, <span class="at">color =</span> location), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot scaled lux</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lux <span class="sc">*</span> lux_scale, <span class="at">color =</span> location), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dual y-axis</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">/</span> lux_scale, <span class="at">name =</span> <span class="st">"Lux"</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Location"</span>, <span class="at">title =</span> <span class="st">"Temperature and Lux by Datetime with Incubation Highlights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bench-incubation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="7200"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>tank2 and tank3 look like they had heaters in them that kept the min temp up near 26F…</p>
<p>TO DO:</p>
<ul>
<li><p>go back and find HOBO log or sea surface temp from July 5th - 8th 2024.</p></li>
<li><p>find calibration to convert lux to PAR</p></li>
</ul>
</div>
</div>
</section>
<section id="averages" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Averages</h1>
<p>What were the average bench, hood, and tank temps &amp; light measurements across the incubation periods?</p>
<p>Subset to the incubation windows</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(datetime, <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Display a table of averages and standard deviations</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>avg_sd <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bench"</span>, <span class="st">"hood"</span> ,<span class="st">"tank2"</span>, <span class="st">"tank3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lux =</span> <span class="fu">mean</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lux =</span> <span class="fu">sd</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>avg_sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">location</th>
<th style="text-align: right;">avg_temp</th>
<th style="text-align: right;">sd_temp</th>
<th style="text-align: right;">avg_lux</th>
<th style="text-align: right;">sd_lux</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bench</td>
<td style="text-align: right;">26.88575</td>
<td style="text-align: right;">0.3975264</td>
<td style="text-align: right;">243.58796</td>
<td style="text-align: right;">495.4855</td>
</tr>
<tr class="even">
<td style="text-align: left;">hood</td>
<td style="text-align: right;">26.85602</td>
<td style="text-align: right;">0.3655191</td>
<td style="text-align: right;">91.64201</td>
<td style="text-align: right;">140.3716</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tank2</td>
<td style="text-align: right;">26.37685</td>
<td style="text-align: right;">0.3216703</td>
<td style="text-align: right;">2498.80348</td>
<td style="text-align: right;">5168.1143</td>
</tr>
<tr class="even">
<td style="text-align: left;">tank3</td>
<td style="text-align: right;">26.33780</td>
<td style="text-align: right;">0.3106606</td>
<td style="text-align: right;">2300.97458</td>
<td style="text-align: right;">5338.2473</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Plot average temps</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_sd, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> avg_temp, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>                                           <span class="co"># mean temps as points</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg_temp <span class="sc">-</span> sd_temp, <span class="at">ymax =</span> avg_temp <span class="sc">+</span> sd_temp), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># std dev error bars</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">title =</span> <span class="st">"Average Temperature with Standard Deviation"</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bench-incubation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="7200"></p>
</figure>
</div>
</div>
</div>
<p>Plot average lux</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_sd, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> avg_lux, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>                                           <span class="co"># mean temps as points</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg_lux <span class="sc">-</span> sd_lux, <span class="at">ymax =</span> avg_lux <span class="sc">+</span> sd_lux), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># std dev error bars</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Lux"</span>, <span class="at">title =</span> <span class="st">"Average lux with Standard Deviation"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bench-incubation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="7200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bench"</span>, <span class="st">"hood"</span>) <span class="sc">~</span> <span class="st">"lab"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"tank2"</span>, <span class="st">"tank3"</span>) <span class="sc">~</span> <span class="st">"ambient"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># for any other location values</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>avg_sd <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"lab"</span>, <span class="st">"ambient"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(space) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lux =</span> <span class="fu">mean</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lux =</span> <span class="fu">sd</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_lux =</span> <span class="fu">min</span> (lux, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_lux =</span> <span class="fu">max</span>(lux, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>avg_sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">space</th>
<th style="text-align: right;">avg_temp</th>
<th style="text-align: right;">sd_temp</th>
<th style="text-align: right;">min_temp</th>
<th style="text-align: right;">max_temp</th>
<th style="text-align: right;">avg_lux</th>
<th style="text-align: right;">sd_lux</th>
<th style="text-align: right;">min_lux</th>
<th style="text-align: right;">max_lux</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ambient</td>
<td style="text-align: right;">26.34765</td>
<td style="text-align: right;">0.3134719</td>
<td style="text-align: right;">25.95</td>
<td style="text-align: right;">27.37</td>
<td style="text-align: right;">2350.852</td>
<td style="text-align: right;">5289.2776</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">31733.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">lab</td>
<td style="text-align: right;">26.87088</td>
<td style="text-align: right;">0.3818228</td>
<td style="text-align: right;">25.91</td>
<td style="text-align: right;">27.84</td>
<td style="text-align: right;">167.615</td>
<td style="text-align: right;">371.6999</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8069.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The incubation temperature conditions were:</p>
<ul>
<li>ambient 26.34 +/- 0.31 C (min 25.95, max 27.37)</li>
<li>lab 26.87 +/- 0.38 C (min 25.91, max 27.84)</li>
</ul>
<p>The incubation lux conditions were:</p>
<ul>
<li>ambient 2350.85 +/- 5289.27 lux (min 0, max 31733.76)</li>
<li>lab 167.61 +/- 371.69 lux (min 0, max 8069.12)</li>
</ul>
</div>
</div>
</section>
<section id="hyopthesis-testing" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Hyopthesis testing</h1>
<section id="is-temp-different-across-location" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="is-temp-different-across-location"><span class="header-section-number">6.1</span> Is temp different across location?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> location, <span class="at">data =</span> all_incubation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.863347</td>
<td style="text-align: right;">0.0023137</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">937</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data has unequal variances (Levene’s test pvalue = 0.002314) so we use Welch’s t-test for ANOVA</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> location, <span class="at">data =</span> all_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  temp and location
F = 173.52, num df = 3.00, denom df = 351.78, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Follow up the Welch’s t-test with a post-hoc test</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> all_incubation<span class="sc">$</span>temp,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> all_incubation<span class="sc">$</span>location,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  all_incubation$temp and all_incubation$location 

      bench  hood   tank2
hood  1      -      -    
tank2 &lt;2e-16 &lt;2e-16 -    
tank3 &lt;2e-16 &lt;2e-16 1    

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pairwise comparisons of temperature across locations using Welch’s t-tests with Bonferroni-adjusted p-values revealed no significant difference between bench and hood (p = 1) or between tank2 and tank3 (p = 1). There is a significant difference (p&lt;0.001) between the lab spaces (the bench and the hood) and the ambient spaces (The lab spaces are significantly different from the ambient spaces (tank2 and tank3).</p>
</div>
</div>
</section>
<section id="is-temp-different-across-space" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="is-temp-different-across-space"><span class="header-section-number">6.2</span> Is temp different across space?</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> space, <span class="at">data =</span> all_incubation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.12683</td>
<td style="text-align: right;">0.0003067</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">939</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data has unequal variances so we use Welch’s t-test for ANOVA</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> space, <span class="at">data =</span> all_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  temp and space
F = 520.18, num df = 1.00, denom df = 852.66, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Follow up the Welch’s t-test with a post-hoc test</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> all_incubation<span class="sc">$</span>temp,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> all_incubation<span class="sc">$</span>space,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  all_incubation$temp and all_incubation$space 

    ambient
lab &lt;2e-16 

P value adjustment method: bonferroni </code></pre>
</div>
</div>
</section>
<section id="is-lab-temp-different-across-stage" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="is-lab-temp-different-across-stage"><span class="header-section-number">6.3</span> Is lab temp different across stage?</h2>
<p>Add a column that indicates the duration of exposure by stage</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_only =</span> <span class="fu">format</span>(datetime, <span class="st">"%H:%M:%S"</span>),      <span class="co"># extract time as string</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_only =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(time_only),            <span class="co"># convert to hms object for easier comparison</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;=</span> <span class="fu">as_hms</span>(<span class="st">"21:20:00"</span>) <span class="sc">|</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"03:30:00"</span>)) <span class="sc">~</span> <span class="st">"cleavage"</span>,                         <span class="co"># crosses midnight</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;</span> <span class="fu">as_hms</span>(<span class="st">"03:30:00"</span>) <span class="sc">&amp;</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"08:30:00"</span>)) <span class="sc">~</span> <span class="st">"prawnchip"</span>,                          <span class="co"># normal range</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;</span> <span class="fu">as_hms</span>(<span class="st">"08:30:00"</span>) <span class="sc">&amp;</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"13:30:00"</span>)) <span class="sc">~</span> <span class="st">"early gastrula"</span>,                     <span class="co"># normal range</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bench_by_stage <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stage)) <span class="sc">%&gt;%</span> <span class="co"># remove rows where stage is missing</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">==</span> <span class="st">"lab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stage) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lux =</span> <span class="fu">mean</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lux =</span> <span class="fu">sd</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_lux =</span> <span class="fu">min</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_lux =</span> <span class="fu">max</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>bench_by_stage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">stage</th>
<th style="text-align: right;">avg_temp</th>
<th style="text-align: right;">sd_temp</th>
<th style="text-align: right;">min_temp</th>
<th style="text-align: right;">max_temp</th>
<th style="text-align: right;">avg_lux</th>
<th style="text-align: right;">sd_lux</th>
<th style="text-align: right;">min_lux</th>
<th style="text-align: right;">max_lux</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cleavage</td>
<td style="text-align: right;">26.87434</td>
<td style="text-align: right;">0.2328657</td>
<td style="text-align: right;">26.08</td>
<td style="text-align: right;">27.24</td>
<td style="text-align: right;">151.7127</td>
<td style="text-align: right;">161.3920</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">409.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">early gastrula</td>
<td style="text-align: right;">26.94533</td>
<td style="text-align: right;">0.5139978</td>
<td style="text-align: right;">25.91</td>
<td style="text-align: right;">27.71</td>
<td style="text-align: right;">201.0156</td>
<td style="text-align: right;">187.5445</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">613.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prawnchip</td>
<td style="text-align: right;">26.79206</td>
<td style="text-align: right;">0.3650893</td>
<td style="text-align: right;">26.17</td>
<td style="text-align: right;">27.84</td>
<td style="text-align: right;">154.3572</td>
<td style="text-align: right;">619.0712</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">8069.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The lab incubation temperature conditions were:</p>
<ul>
<li>cleavage 26.87 +/- 0.23 C (min 26.08, max 27.24)</li>
<li>prawnchip 26.79 +/- 0.36 C (min 26.17, max 27.84)</li>
<li>early gastrula 26.94 +/- 0.51 C (min 25.91, max 27.71)</li>
</ul>
<p>The lab incubation lux conditions were:</p>
<ul>
<li>cleavage 151.7127 +/- 161.39 lux (min 0, max 409.28)</li>
<li>prawnchip 154.35 +/- 619.07 lux (min 0, max 8069.12)</li>
<li>early gastrula 201.01 +/- 187.54 (min 0.81, max 613.60)</li>
</ul>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stage)) <span class="sc">%&gt;%</span> <span class="co"># remove rows where stage is missing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">==</span> <span class="st">"lab"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> stage, <span class="at">data =</span> lab_incubation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">73.8332</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data has unequal variances so we use Welch’s t-test for ANOVA</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> stage, <span class="at">data =</span> lab_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  temp and stage
F = 5.9606, num df = 2.00, denom df = 320.16, p-value = 0.002873</code></pre>
</div>
</div>
<p>Follow up the Welch’s t-test with a post-hoc test</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lab_incubation<span class="sc">$</span>temp,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> lab_incubation<span class="sc">$</span>stage,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  lab_incubation$temp and lab_incubation$stage 

               cleavage early gastrula
early gastrula 0.2608   -             
prawnchip      0.0269   0.0037        

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pairwise comparisons of temperature across stage using Welch’s t-tests with Bonferroni-adjusted p-values revealed the temperatures experienced during the latest embryonic stage (early gastrula) are significantly different from the prawnchip stage (p&lt;0.05). <strong>HOWEVER, the actual temperature range experienced across embryonic development (26.79-26.94) is within the ambient seawater range and is ecologically parallel to the natural sea surface temp fluctuations experienced in a diurnal cycle.</strong></p>
</div>
</div>
</section>
<section id="is-lab-temp-different-across-spawn-night" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="is-lab-temp-different-across-spawn-night"><span class="header-section-number">6.4</span> Is lab temp different across spawn night?</h2>
<p>Add a column that indicates the spawn night (1, 2, or 3)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">spawn =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">1</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">1</span>] <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">2</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">3</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">3</span>] <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Print a table of temps and lux by spawn night</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>by_spawn <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(spawn) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lux =</span> <span class="fu">mean</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lux =</span> <span class="fu">sd</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_lux =</span> <span class="fu">min</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_lux =</span> <span class="fu">max</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>by_spawn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">spawn</th>
<th style="text-align: right;">avg_temp</th>
<th style="text-align: right;">sd_temp</th>
<th style="text-align: right;">min_temp</th>
<th style="text-align: right;">max_temp</th>
<th style="text-align: right;">avg_lux</th>
<th style="text-align: right;">sd_lux</th>
<th style="text-align: right;">min_lux</th>
<th style="text-align: right;">max_lux</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.23163</td>
<td style="text-align: right;">0.2814402</td>
<td style="text-align: right;">26.60</td>
<td style="text-align: right;">27.84</td>
<td style="text-align: right;">213.6418</td>
<td style="text-align: right;">594.5645</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8069.12</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">26.85444</td>
<td style="text-align: right;">0.2351807</td>
<td style="text-align: right;">26.21</td>
<td style="text-align: right;">27.24</td>
<td style="text-align: right;">149.9682</td>
<td style="text-align: right;">167.1667</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">472.48</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">26.52658</td>
<td style="text-align: right;">0.2326195</td>
<td style="text-align: right;">25.91</td>
<td style="text-align: right;">27.24</td>
<td style="text-align: right;">139.2350</td>
<td style="text-align: right;">176.6241</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">613.60</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spawn =</span> <span class="fu">factor</span>(spawn, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>)))  <span class="co"># convert spawn to factor with labels</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> spawn, <span class="at">data =</span> lab_incubation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10.11787</td>
<td style="text-align: right;">4.79e-05</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our data has unequal variances so we use Welch’s t-test for ANOVA</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> spawn, <span class="at">data =</span> lab_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  temp and spawn
F = 366.72, num df = 2.00, denom df = 387.43, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Follow up the Welch’s t-test with a post-hoc test</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lab_incubation<span class="sc">$</span>temp,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> lab_incubation<span class="sc">$</span>spawn,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  lab_incubation$temp and lab_incubation$spawn 

  1      2     
2 &lt;2e-16 -     
3 &lt;2e-16 &lt;2e-16

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pairwise comparisons of temperature across spawn night using Welch’s t-tests with Bonferroni-adjusted p-values revealed that each night is significantly different (p&lt;2.2e-16). <strong>HOWEVER the actual range of temps across all three spawn nights is 26.5 to 27.2 (less than 1C), and is an ecological parallel to actual fluctuations in sea surface temp that occur across nights of spawning.</strong></p>
</div>
</div>
</section>
</section>
<section id="summary" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Summary</h1>
<p><strong>Temperature</strong> Although statistically significant differences in temperature were detected across both spawn nights (with temperatures generally decreasing over the three nights) and developmental stage (with the lowest temperatures observed just before dawn during the prawnchip stage, but no significant difference between the cleavage and early gastrula stages), the magnitude of these differences was small and remained within the normal range of ambient seawater temperature fluctuations observed during a spawning event. Therefore, while temperature varied somewhat across the experimental assay, this variation is minor and unlikely to confound our results, as embryos in nature develop under similar thermal conditions.</p>
<p><strong>Light</strong></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sarahtanja\.github\.io\/quarto-blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb39" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Bench Incubation"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Lab bench records and environmental logs for the development of *Montipora capitata* embryos exposed to PVC leachate"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 07/09/2024</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [protocols, records]</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Background</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>On July 5th, 6th, and 7th 2024 we conducted an ecotox assay on the development of *Montipora capitata* coral embryo development under exposure to PVC leachate at nominal concentrations of 0 mg/L (0.22um FSW, control), 0.01 mg/L (low), 0.1 mg/L (mid), and 1 mg/L (high). We repeated our assay across three nights of spawning. In the assay, embryos were incubated in 20mL scintillation vials in a climate-controlled lab. Here we detail the conditions of the incubation period.</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>We left a HOBO logger out on the lab bench, in the lab hood, and in an ambient flow through holding tank where adult coral colonies were being kept. We will compare the data here.</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inputs</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>HOBO data logs</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>average Temp calibration factors</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>average PAR calibration factors</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outputs</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Visualizations comparing the lab bench conditions to the ambient seawater at HIMB around the July *Montipora capitata* spawning event in 2024.</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Hypothesis testing results comparing lab conditions across spawn night and stage</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Average conditions for manuscript methods section</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tables of conditions for manuscript supplemental materials</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.width = 12,</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.height = 8,</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.align = "center",</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="in">  dpi = 600,</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="in">  echo = TRUE,         # Display code chunks</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="in">  eval = TRUE,        # Evaluate code chunks</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="in">  warning = FALSE,     # Hide warnings</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="in">  message = FALSE,     # Hide messages</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="in">  comment = ""         # Prevents appending '##' to beginning of lines in code output</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install packages</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="in">if ("tidyverse" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="in">if ("reshape2" %in% rownames(installed.packages()) == 'FALSE') install.packages('reshape2')</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="in">if ("plotly" %in% rownames(installed.packages()) == 'FALSE') install.packages('plotly')</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a><span class="in">if ("car" %in% rownames(installed.packages()) == 'FALSE') install.packages('car')</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="in">if ("agricolae" %in% rownames(installed.packages()) == 'FALSE') install.packages('agricolae')</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="in">if ("hms" %in% rownames(installed.packages()) == 'FALSE') install.packages('hms')</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load packages</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># for Levene's test </span></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae) <span class="co"># for post-hoc tests</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load HOBO logs</span></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"embryo-inc-bench 2024-07-08 13_34_32 HST (Data HST).csv"</span>)</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>hood <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"embryo-inc-hood 2024-07-08 13_35_01 HST (Data HST).csv"</span>)</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>tank1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Holding tank  2024-07-03 15_30_47 HST (Data HST).csv"</span>)</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>tank2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Holding tank  2024-07-08 08_32_55 HST (Data HST).csv"</span>)</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>tank3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"AmbientTemp2 2024-07-08 08_32_20 HST (Data HST).csv"</span>)</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load HOBO calibration factors</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>par_cal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"avg_par.csv"</span>)</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>temp_cal <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"avg_temp.csv"</span>)   </span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a><span class="fu"># Format HOBO logs</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> bench <span class="sc">%&gt;%</span> </span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"bench"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>hood <span class="ot">&lt;-</span> hood <span class="sc">%&gt;%</span> </span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"hood"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>tank1 <span class="ot">&lt;-</span> tank1 <span class="sc">%&gt;%</span> </span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>tank2 <span class="ot">&lt;-</span> tank2 <span class="sc">%&gt;%</span> </span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>tank3 <span class="ot">&lt;-</span> tank3 <span class="sc">%&gt;%</span> </span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">datetime =</span> Date.Time..HST.,</span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> Temperature.....C.,</span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">lux =</span> Light....lux.) <span class="sc">%&gt;%</span> </span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="st">"tank3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(datetime, temp, lux, location)</span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(bench, hood, tank1, tank2, tank3)</span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a>all<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(all<span class="sc">$</span>datetime, <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Apply calibrations to HOBO logs</span></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a>To apply the intercept and slope from a linear regression calibration to raw data and generate calibrated values, we can use the formula:</span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a>\text{Calibrated value} = (\text{slope} \times \text{raw value}) + \text{intercept}</span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a>The calibration slopes and intercepts for <span class="in">`temp`</span> and <span class="in">`lux ➡️PAR`</span> are:</span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(par_cal)</span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(temp_cal)</span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span> </span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raw_temp =</span> temp) <span class="sc">%&gt;%</span> </span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">cal_temp =</span> (temp_cal<span class="sc">$</span>avg_temp_slope <span class="sc">*</span> raw_temp) <span class="sc">+</span> temp_cal<span class="sc">$</span>avg_temp_intercept,</span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> (par_cal<span class="sc">$</span>avg_par_slope <span class="sc">*</span> lux) <span class="sc">+</span> par_cal<span class="sc">$</span>avg_par_intercept,</span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">par_adj =</span> par <span class="sc">+</span> <span class="dv">1500</span>)</span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a><span class="fu"># Plot overlapping logs</span></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a>The incubation windows were:</span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a>1- July 5th 21:20 - July 6th 13:30</span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a>2 - July 6th 21:20 - July 7th 13:30</span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a>3- July 7th 21:20 - July 8th 13:30</span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a>incubation_windows <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">"07/05/2024 21:20:00"</span>, </span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"07/06/2024 21:20:00"</span>, </span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"07/07/2024 21:20:00"</span>), </span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a>                     <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>),</span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">end =</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">"07/06/2024 13:30:00"</span>, </span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"07/07/2024 13:30:00"</span>, </span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"07/08/2024 13:30:00"</span>), </span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>))</span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a>Clip plot to just experimental incubations (07/05/2024 21:20:00 - 07/08/2024 13:30:00)</span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Define start and end of all three spawning nights</span></span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">"07/05/2024 21:20:00"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">"07/08/2024 13:30:00"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%Y %H:%M:%S"</span>)</span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where datetime is within the window</span></span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a>all_inc <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(datetime <span class="sc">&gt;=</span> start <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> end)</span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_inc, <span class="fu">aes</span>(<span class="at">x =</span> datetime)) <span class="sc">+</span></span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> incubation_windows,</span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xmin =</span> start, <span class="at">xmax =</span> end),</span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cal_temp, <span class="at">color =</span> location), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(</span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a>  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">26</span>, <span class="dv">28</span>))</span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Location"</span>,</span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Temperature by Datetime with Incubation Windows Highlighted"</span></span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-225"><a href="#cb39-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-226"><a href="#cb39-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-227"><a href="#cb39-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-230"><a href="#cb39-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-231"><a href="#cb39-231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_inc, <span class="fu">aes</span>(<span class="at">x =</span> datetime)) <span class="sc">+</span></span>
<span id="cb39-232"><a href="#cb39-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb39-233"><a href="#cb39-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> incubation_windows,</span>
<span id="cb39-234"><a href="#cb39-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xmin =</span> start, <span class="at">xmax =</span> end),</span>
<span id="cb39-235"><a href="#cb39-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb39-236"><a href="#cb39-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-237"><a href="#cb39-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb39-238"><a href="#cb39-238" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-239"><a href="#cb39-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> par_adj, <span class="at">color =</span> location), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb39-240"><a href="#cb39-240" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(</span>
<span id="cb39-241"><a href="#cb39-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"PAR"</span>,</span>
<span id="cb39-242"><a href="#cb39-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">2000</span>))</span>
<span id="cb39-243"><a href="#cb39-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-244"><a href="#cb39-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-245"><a href="#cb39-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Location"</span>,</span>
<span id="cb39-246"><a href="#cb39-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"PAR by Datetime with Incubation Windows Highlighted"</span></span>
<span id="cb39-247"><a href="#cb39-247" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-248"><a href="#cb39-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-249"><a href="#cb39-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-250"><a href="#cb39-250" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-251"><a href="#cb39-251" aria-hidden="true" tabindex="-1"></a>tank2 and tank3 look like they had heaters in them that kept the min temp up near 26F...</span>
<span id="cb39-252"><a href="#cb39-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-253"><a href="#cb39-253" aria-hidden="true" tabindex="-1"></a>TO DO:</span>
<span id="cb39-254"><a href="#cb39-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-255"><a href="#cb39-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>go back and find HOBO log or sea surface temp from July 5th - 8th 2024.</span>
<span id="cb39-256"><a href="#cb39-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-257"><a href="#cb39-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>find calibration to convert lux to PAR</span>
<span id="cb39-258"><a href="#cb39-258" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-259"><a href="#cb39-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-260"><a href="#cb39-260" aria-hidden="true" tabindex="-1"></a><span class="fu"># Averages</span></span>
<span id="cb39-261"><a href="#cb39-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-262"><a href="#cb39-262" aria-hidden="true" tabindex="-1"></a>What were the average bench, hood, and tank temps &amp; light measurements across the incubation periods?</span>
<span id="cb39-263"><a href="#cb39-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-264"><a href="#cb39-264" aria-hidden="true" tabindex="-1"></a>Subset to the incubation windows</span>
<span id="cb39-265"><a href="#cb39-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-268"><a href="#cb39-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-269"><a href="#cb39-269" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span> </span>
<span id="cb39-270"><a href="#cb39-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb39-271"><a href="#cb39-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(datetime, <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end))</span>
<span id="cb39-272"><a href="#cb39-272" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-273"><a href="#cb39-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-274"><a href="#cb39-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-275"><a href="#cb39-275" aria-hidden="true" tabindex="-1"></a>Display a table of averages and standard deviations</span>
<span id="cb39-276"><a href="#cb39-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-279"><a href="#cb39-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-280"><a href="#cb39-280" aria-hidden="true" tabindex="-1"></a>avg_sd <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-281"><a href="#cb39-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bench"</span>, <span class="st">"hood"</span> ,<span class="st">"tank2"</span>, <span class="st">"tank3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-282"><a href="#cb39-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb39-283"><a href="#cb39-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-284"><a href="#cb39-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-285"><a href="#cb39-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb39-286"><a href="#cb39-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_par =</span> <span class="fu">mean</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-287"><a href="#cb39-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_par =</span> <span class="fu">sd</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb39-288"><a href="#cb39-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-289"><a href="#cb39-289" aria-hidden="true" tabindex="-1"></a>avg_sd</span>
<span id="cb39-290"><a href="#cb39-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-291"><a href="#cb39-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-292"><a href="#cb39-292" aria-hidden="true" tabindex="-1"></a>Plot average temps</span>
<span id="cb39-293"><a href="#cb39-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-296"><a href="#cb39-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-297"><a href="#cb39-297" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_sd, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> avg_temp, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb39-298"><a href="#cb39-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>                                           <span class="co"># mean temps as points</span></span>
<span id="cb39-299"><a href="#cb39-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg_temp <span class="sc">-</span> sd_temp, <span class="at">ymax =</span> avg_temp <span class="sc">+</span> sd_temp), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># std dev error bars</span></span>
<span id="cb39-300"><a href="#cb39-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>, <span class="at">title =</span> <span class="st">"Average Temperature with Standard Deviation"</span>) <span class="sc">+</span></span>
<span id="cb39-301"><a href="#cb39-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-302"><a href="#cb39-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-303"><a href="#cb39-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-304"><a href="#cb39-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-305"><a href="#cb39-305" aria-hidden="true" tabindex="-1"></a>Plot average par</span>
<span id="cb39-306"><a href="#cb39-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-309"><a href="#cb39-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-310"><a href="#cb39-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_sd, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> avg_par, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb39-311"><a href="#cb39-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>                                           <span class="co"># mean temps as points</span></span>
<span id="cb39-312"><a href="#cb39-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> avg_par <span class="sc">-</span> sd_par, <span class="at">ymax =</span> avg_par <span class="sc">+</span> sd_par), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># std dev error bars</span></span>
<span id="cb39-313"><a href="#cb39-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"PAR"</span>, <span class="at">title =</span> <span class="st">"Average PAR with Standard Deviation"</span>) <span class="sc">+</span></span>
<span id="cb39-314"><a href="#cb39-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-315"><a href="#cb39-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-316"><a href="#cb39-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-319"><a href="#cb39-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-320"><a href="#cb39-320" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span> </span>
<span id="cb39-321"><a href="#cb39-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-322"><a href="#cb39-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">space =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-323"><a href="#cb39-323" aria-hidden="true" tabindex="-1"></a>      location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"bench"</span>, <span class="st">"hood"</span>) <span class="sc">~</span> <span class="st">"lab"</span>,</span>
<span id="cb39-324"><a href="#cb39-324" aria-hidden="true" tabindex="-1"></a>      location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"tank2"</span>, <span class="st">"tank3"</span>) <span class="sc">~</span> <span class="st">"ambient"</span>,</span>
<span id="cb39-325"><a href="#cb39-325" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># for any other location values</span></span>
<span id="cb39-326"><a href="#cb39-326" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-327"><a href="#cb39-327" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-328"><a href="#cb39-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-329"><a href="#cb39-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-332"><a href="#cb39-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-333"><a href="#cb39-333" aria-hidden="true" tabindex="-1"></a>avg_sd <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-334"><a href="#cb39-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"lab"</span>, <span class="st">"ambient"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-335"><a href="#cb39-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(space) <span class="sc">%&gt;%</span></span>
<span id="cb39-336"><a href="#cb39-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-337"><a href="#cb39-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-338"><a href="#cb39-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-339"><a href="#cb39-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-340"><a href="#cb39-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-341"><a href="#cb39-341" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_par =</span> <span class="fu">mean</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-342"><a href="#cb39-342" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_par =</span> <span class="fu">sd</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-343"><a href="#cb39-343" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_par =</span> <span class="fu">min</span> (par, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb39-344"><a href="#cb39-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_par =</span> <span class="fu">max</span>(par, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb39-345"><a href="#cb39-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-346"><a href="#cb39-346" aria-hidden="true" tabindex="-1"></a>avg_sd</span>
<span id="cb39-347"><a href="#cb39-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-348"><a href="#cb39-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-349"><a href="#cb39-349" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-350"><a href="#cb39-350" aria-hidden="true" tabindex="-1"></a>The incubation temperature conditions were:</span>
<span id="cb39-351"><a href="#cb39-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-352"><a href="#cb39-352" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ambient 26.34 +/- 0.31 C (min 25.95, max 27.37)</span>
<span id="cb39-353"><a href="#cb39-353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lab 26.87 +/- 0.38 C (min 25.91, max 27.84)</span>
<span id="cb39-354"><a href="#cb39-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-355"><a href="#cb39-355" aria-hidden="true" tabindex="-1"></a>The incubation lux conditions were:</span>
<span id="cb39-356"><a href="#cb39-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-357"><a href="#cb39-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ambient 2350.85 +/- 5289.27 lux (min 0, max 31733.76)</span>
<span id="cb39-358"><a href="#cb39-358" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lab 167.61 +/- 371.69 lux (min 0, max 8069.12)</span>
<span id="cb39-359"><a href="#cb39-359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-360"><a href="#cb39-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-361"><a href="#cb39-361" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hyopthesis testing</span></span>
<span id="cb39-362"><a href="#cb39-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-363"><a href="#cb39-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Is temp different across location?</span></span>
<span id="cb39-364"><a href="#cb39-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-367"><a href="#cb39-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-368"><a href="#cb39-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb39-369"><a href="#cb39-369" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(cal_temp <span class="sc">~</span> location, <span class="at">data =</span> all_incubation)</span>
<span id="cb39-370"><a href="#cb39-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-371"><a href="#cb39-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-372"><a href="#cb39-372" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-373"><a href="#cb39-373" aria-hidden="true" tabindex="-1"></a>Our data has unequal variances (Levene's test pvalue = 0.002314) so we use Welch's t-test for ANOVA</span>
<span id="cb39-374"><a href="#cb39-374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-375"><a href="#cb39-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-378"><a href="#cb39-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-379"><a href="#cb39-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb39-380"><a href="#cb39-380" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(cal_temp <span class="sc">~</span> location, <span class="at">data =</span> all_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-381"><a href="#cb39-381" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span>
<span id="cb39-382"><a href="#cb39-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-383"><a href="#cb39-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-384"><a href="#cb39-384" aria-hidden="true" tabindex="-1"></a>Follow up the Welch's t-test with a post-hoc test</span>
<span id="cb39-385"><a href="#cb39-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-388"><a href="#cb39-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-389"><a href="#cb39-389" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb39-390"><a href="#cb39-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> all_incubation<span class="sc">$</span>cal_temp,</span>
<span id="cb39-391"><a href="#cb39-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> all_incubation<span class="sc">$</span>location,</span>
<span id="cb39-392"><a href="#cb39-392" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb39-393"><a href="#cb39-393" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb39-394"><a href="#cb39-394" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-395"><a href="#cb39-395" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb39-396"><a href="#cb39-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-397"><a href="#cb39-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-398"><a href="#cb39-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-399"><a href="#cb39-399" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-400"><a href="#cb39-400" aria-hidden="true" tabindex="-1"></a>Pairwise comparisons of temperature across locations using Welch’s t-tests with Bonferroni-adjusted p-values revealed no significant difference between bench and hood (p = 1) or between tank2 and tank3 (p = 1). There is a significant difference (p<span class="sc">\&lt;</span>0.001) between the lab spaces (the bench and the hood) and the ambient spaces (The lab spaces are significantly different from the ambient spaces (tank2 and tank3).</span>
<span id="cb39-401"><a href="#cb39-401" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-402"><a href="#cb39-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-403"><a href="#cb39-403" aria-hidden="true" tabindex="-1"></a><span class="fu">## Is temp different across space?</span></span>
<span id="cb39-404"><a href="#cb39-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-407"><a href="#cb39-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-408"><a href="#cb39-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb39-409"><a href="#cb39-409" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(cal_temp <span class="sc">~</span> space, <span class="at">data =</span> all_incubation)</span>
<span id="cb39-410"><a href="#cb39-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-411"><a href="#cb39-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-412"><a href="#cb39-412" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-413"><a href="#cb39-413" aria-hidden="true" tabindex="-1"></a>Our data has unequal variances so we use Welch's t-test for ANOVA</span>
<span id="cb39-414"><a href="#cb39-414" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-415"><a href="#cb39-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-418"><a href="#cb39-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-419"><a href="#cb39-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb39-420"><a href="#cb39-420" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(cal_temp <span class="sc">~</span> space, <span class="at">data =</span> all_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-421"><a href="#cb39-421" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span>
<span id="cb39-422"><a href="#cb39-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-423"><a href="#cb39-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-424"><a href="#cb39-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-425"><a href="#cb39-425" aria-hidden="true" tabindex="-1"></a>Follow up the Welch's t-test with a post-hoc test</span>
<span id="cb39-426"><a href="#cb39-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-429"><a href="#cb39-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-430"><a href="#cb39-430" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb39-431"><a href="#cb39-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> all_incubation<span class="sc">$</span>cal_temp,</span>
<span id="cb39-432"><a href="#cb39-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> all_incubation<span class="sc">$</span>space,</span>
<span id="cb39-433"><a href="#cb39-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb39-434"><a href="#cb39-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb39-435"><a href="#cb39-435" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-436"><a href="#cb39-436" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb39-437"><a href="#cb39-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-438"><a href="#cb39-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-439"><a href="#cb39-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-440"><a href="#cb39-440" aria-hidden="true" tabindex="-1"></a><span class="fu">## Is lab temp different across stage?</span></span>
<span id="cb39-441"><a href="#cb39-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-442"><a href="#cb39-442" aria-hidden="true" tabindex="-1"></a>Add a column that indicates the duration of exposure by stage</span>
<span id="cb39-443"><a href="#cb39-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-446"><a href="#cb39-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-447"><a href="#cb39-447" aria-hidden="true" tabindex="-1"></a>all_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-448"><a href="#cb39-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-449"><a href="#cb39-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_only =</span> <span class="fu">format</span>(datetime, <span class="st">"%H:%M:%S"</span>),      <span class="co"># extract time as string</span></span>
<span id="cb39-450"><a href="#cb39-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_only =</span> hms<span class="sc">::</span><span class="fu">as_hms</span>(time_only),            <span class="co"># convert to hms object for easier comparison</span></span>
<span id="cb39-451"><a href="#cb39-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-452"><a href="#cb39-452" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;=</span> <span class="fu">as_hms</span>(<span class="st">"21:20:00"</span>) <span class="sc">|</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"03:30:00"</span>)) <span class="sc">~</span> <span class="st">"cleavage"</span>,                         <span class="co"># crosses midnight</span></span>
<span id="cb39-453"><a href="#cb39-453" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;</span> <span class="fu">as_hms</span>(<span class="st">"03:30:00"</span>) <span class="sc">&amp;</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"08:30:00"</span>)) <span class="sc">~</span> <span class="st">"prawnchip"</span>,                          <span class="co"># normal range</span></span>
<span id="cb39-454"><a href="#cb39-454" aria-hidden="true" tabindex="-1"></a>      (time_only <span class="sc">&gt;</span> <span class="fu">as_hms</span>(<span class="st">"08:30:00"</span>) <span class="sc">&amp;</span> time_only <span class="sc">&lt;=</span> <span class="fu">as_hms</span>(<span class="st">"13:30:00"</span>)) <span class="sc">~</span> <span class="st">"early gastrula"</span>,                     <span class="co"># normal range</span></span>
<span id="cb39-455"><a href="#cb39-455" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb39-456"><a href="#cb39-456" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-457"><a href="#cb39-457" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-458"><a href="#cb39-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-459"><a href="#cb39-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-462"><a href="#cb39-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-463"><a href="#cb39-463" aria-hidden="true" tabindex="-1"></a>bench_by_stage <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-464"><a href="#cb39-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stage)) <span class="sc">%&gt;%</span> <span class="co"># remove rows where stage is missing</span></span>
<span id="cb39-465"><a href="#cb39-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">==</span> <span class="st">"lab"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-466"><a href="#cb39-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(stage) <span class="sc">%&gt;%</span></span>
<span id="cb39-467"><a href="#cb39-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-468"><a href="#cb39-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-469"><a href="#cb39-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-470"><a href="#cb39-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-471"><a href="#cb39-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(cal_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-472"><a href="#cb39-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_par =</span> <span class="fu">mean</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-473"><a href="#cb39-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_par =</span> <span class="fu">sd</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-474"><a href="#cb39-474" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_par =</span> <span class="fu">min</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-475"><a href="#cb39-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_par =</span> <span class="fu">max</span>(par, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-476"><a href="#cb39-476" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-477"><a href="#cb39-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-478"><a href="#cb39-478" aria-hidden="true" tabindex="-1"></a>bench_by_stage</span>
<span id="cb39-479"><a href="#cb39-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-480"><a href="#cb39-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-481"><a href="#cb39-481" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-482"><a href="#cb39-482" aria-hidden="true" tabindex="-1"></a>The lab incubation temperature conditions were:</span>
<span id="cb39-483"><a href="#cb39-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-484"><a href="#cb39-484" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>cleavage 26.87 +/- 0.23 C (min 26.08, max 27.24)</span>
<span id="cb39-485"><a href="#cb39-485" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>prawnchip 26.79 +/- 0.36 C (min 26.17, max 27.84)</span>
<span id="cb39-486"><a href="#cb39-486" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>early gastrula 26.94 +/- 0.51 C (min 25.91, max 27.71)</span>
<span id="cb39-487"><a href="#cb39-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-488"><a href="#cb39-488" aria-hidden="true" tabindex="-1"></a>The lab incubation lux conditions were:</span>
<span id="cb39-489"><a href="#cb39-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-490"><a href="#cb39-490" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>cleavage 151.7127 +/- 161.39 lux (min 0, max 409.28)</span>
<span id="cb39-491"><a href="#cb39-491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>prawnchip 154.35 +/- 619.07 lux (min 0, max 8069.12)</span>
<span id="cb39-492"><a href="#cb39-492" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>early gastrula 201.01 +/- 187.54 (min 0.81, max 613.60)</span>
<span id="cb39-493"><a href="#cb39-493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-494"><a href="#cb39-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-497"><a href="#cb39-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-498"><a href="#cb39-498" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> all_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-499"><a href="#cb39-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stage)) <span class="sc">%&gt;%</span> <span class="co"># remove rows where stage is missing</span></span>
<span id="cb39-500"><a href="#cb39-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(space <span class="sc">==</span> <span class="st">"lab"</span>)</span>
<span id="cb39-501"><a href="#cb39-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-502"><a href="#cb39-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb39-503"><a href="#cb39-503" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> stage, <span class="at">data =</span> lab_incubation)</span>
<span id="cb39-504"><a href="#cb39-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-505"><a href="#cb39-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-506"><a href="#cb39-506" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-507"><a href="#cb39-507" aria-hidden="true" tabindex="-1"></a>Our data has unequal variances so we use Welch's t-test for ANOVA</span>
<span id="cb39-508"><a href="#cb39-508" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-509"><a href="#cb39-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-512"><a href="#cb39-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-513"><a href="#cb39-513" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb39-514"><a href="#cb39-514" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> stage, <span class="at">data =</span> lab_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-515"><a href="#cb39-515" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span>
<span id="cb39-516"><a href="#cb39-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-517"><a href="#cb39-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-518"><a href="#cb39-518" aria-hidden="true" tabindex="-1"></a>Follow up the Welch's t-test with a post-hoc test</span>
<span id="cb39-519"><a href="#cb39-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-522"><a href="#cb39-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-523"><a href="#cb39-523" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb39-524"><a href="#cb39-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lab_incubation<span class="sc">$</span>temp,</span>
<span id="cb39-525"><a href="#cb39-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> lab_incubation<span class="sc">$</span>stage,</span>
<span id="cb39-526"><a href="#cb39-526" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb39-527"><a href="#cb39-527" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb39-528"><a href="#cb39-528" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-529"><a href="#cb39-529" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb39-530"><a href="#cb39-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-531"><a href="#cb39-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-532"><a href="#cb39-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-533"><a href="#cb39-533" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-534"><a href="#cb39-534" aria-hidden="true" tabindex="-1"></a>Pairwise comparisons of temperature across stage using Welch’s t-tests with Bonferroni-adjusted p-values revealed the temperatures experienced during the latest embryonic stage (early gastrula) are significantly different from the prawnchip stage (p<span class="sc">\&lt;</span>0.05). **HOWEVER, the actual temperature range experienced across embryonic development (26.79-26.94) is within the ambient seawater range and is ecologically parallel to the natural sea surface temp fluctuations experienced in a diurnal cycle.**</span>
<span id="cb39-535"><a href="#cb39-535" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-536"><a href="#cb39-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-537"><a href="#cb39-537" aria-hidden="true" tabindex="-1"></a><span class="fu">## Is lab temp different across spawn night?</span></span>
<span id="cb39-538"><a href="#cb39-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-539"><a href="#cb39-539" aria-hidden="true" tabindex="-1"></a>Add a column that indicates the spawn night (1, 2, or 3)</span>
<span id="cb39-540"><a href="#cb39-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-543"><a href="#cb39-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-544"><a href="#cb39-544" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-545"><a href="#cb39-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-546"><a href="#cb39-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">spawn =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-547"><a href="#cb39-547" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">1</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">1</span>] <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb39-548"><a href="#cb39-548" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">2</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb39-549"><a href="#cb39-549" aria-hidden="true" tabindex="-1"></a>      datetime <span class="sc">&gt;=</span> incubation_windows<span class="sc">$</span>start[<span class="dv">3</span>] <span class="sc">&amp;</span> datetime <span class="sc">&lt;=</span> incubation_windows<span class="sc">$</span>end[<span class="dv">3</span>] <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb39-550"><a href="#cb39-550" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb39-551"><a href="#cb39-551" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-552"><a href="#cb39-552" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-553"><a href="#cb39-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-554"><a href="#cb39-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-555"><a href="#cb39-555" aria-hidden="true" tabindex="-1"></a>Print a table of temps and lux by spawn night</span>
<span id="cb39-556"><a href="#cb39-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-559"><a href="#cb39-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-560"><a href="#cb39-560" aria-hidden="true" tabindex="-1"></a>by_spawn <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span></span>
<span id="cb39-561"><a href="#cb39-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(spawn) <span class="sc">%&gt;%</span></span>
<span id="cb39-562"><a href="#cb39-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-563"><a href="#cb39-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-564"><a href="#cb39-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_temp =</span> <span class="fu">sd</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-565"><a href="#cb39-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_temp =</span> <span class="fu">min</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-566"><a href="#cb39-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_temp =</span> <span class="fu">max</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-567"><a href="#cb39-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lux =</span> <span class="fu">mean</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-568"><a href="#cb39-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lux =</span> <span class="fu">sd</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-569"><a href="#cb39-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_lux =</span> <span class="fu">min</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-570"><a href="#cb39-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_lux =</span> <span class="fu">max</span>(lux, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-571"><a href="#cb39-571" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-572"><a href="#cb39-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-573"><a href="#cb39-573" aria-hidden="true" tabindex="-1"></a>by_spawn</span>
<span id="cb39-574"><a href="#cb39-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-575"><a href="#cb39-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-578"><a href="#cb39-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-579"><a href="#cb39-579" aria-hidden="true" tabindex="-1"></a>lab_incubation <span class="ot">&lt;-</span> lab_incubation <span class="sc">%&gt;%</span> </span>
<span id="cb39-580"><a href="#cb39-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spawn =</span> <span class="fu">factor</span>(spawn, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb39-581"><a href="#cb39-581" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>)))  <span class="co"># convert spawn to factor with labels</span></span>
<span id="cb39-582"><a href="#cb39-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance</span></span>
<span id="cb39-583"><a href="#cb39-583" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(temp <span class="sc">~</span> spawn, <span class="at">data =</span> lab_incubation)</span>
<span id="cb39-584"><a href="#cb39-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-585"><a href="#cb39-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-586"><a href="#cb39-586" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-587"><a href="#cb39-587" aria-hidden="true" tabindex="-1"></a>Our data has unequal variances so we use Welch's t-test for ANOVA</span>
<span id="cb39-588"><a href="#cb39-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-589"><a href="#cb39-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-592"><a href="#cb39-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-593"><a href="#cb39-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch's ANOVA comparing temperature by stage</span></span>
<span id="cb39-594"><a href="#cb39-594" aria-hidden="true" tabindex="-1"></a>welch_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(temp <span class="sc">~</span> spawn, <span class="at">data =</span> lab_incubation, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-595"><a href="#cb39-595" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(welch_anova)</span>
<span id="cb39-596"><a href="#cb39-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-597"><a href="#cb39-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-598"><a href="#cb39-598" aria-hidden="true" tabindex="-1"></a>Follow up the Welch's t-test with a post-hoc test</span>
<span id="cb39-599"><a href="#cb39-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-602"><a href="#cb39-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-603"><a href="#cb39-603" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(</span>
<span id="cb39-604"><a href="#cb39-604" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lab_incubation<span class="sc">$</span>temp,</span>
<span id="cb39-605"><a href="#cb39-605" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> lab_incubation<span class="sc">$</span>spawn,</span>
<span id="cb39-606"><a href="#cb39-606" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb39-607"><a href="#cb39-607" aria-hidden="true" tabindex="-1"></a>  <span class="at">pool.sd =</span> <span class="cn">FALSE</span></span>
<span id="cb39-608"><a href="#cb39-608" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-609"><a href="#cb39-609" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb39-610"><a href="#cb39-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-611"><a href="#cb39-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-612"><a href="#cb39-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-613"><a href="#cb39-613" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb39-614"><a href="#cb39-614" aria-hidden="true" tabindex="-1"></a>Pairwise comparisons of temperature across spawn night using Welch’s t-tests with Bonferroni-adjusted p-values revealed that each night is significantly different (p<span class="sc">\&lt;</span>2.2e-16). **HOWEVER the actual range of temps across all three spawn nights is 26.5 to 27.2 (less than 1C), and is an ecological parallel to actual fluctuations in sea surface temp that occur across nights of spawning.**</span>
<span id="cb39-615"><a href="#cb39-615" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb39-616"><a href="#cb39-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-617"><a href="#cb39-617" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb39-618"><a href="#cb39-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-619"><a href="#cb39-619" aria-hidden="true" tabindex="-1"></a>**Temperature**</span>
<span id="cb39-620"><a href="#cb39-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-621"><a href="#cb39-621" aria-hidden="true" tabindex="-1"></a>Although statistically significant differences in temperature were detected across both spawn nights (with temperatures generally decreasing over the three nights) and developmental stage (with the lowest temperatures observed just before dawn during the prawnchip stage, but no significant difference between the cleavage and early gastrula stages), the magnitude of these differences was small and remained within the normal range of ambient seawater temperature fluctuations observed during a spawning event. Therefore, while temperature varied somewhat across the experimental assay, this variation is minor and unlikely to confound our results, as embryos in nature develop under similar thermal conditions.</span>
<span id="cb39-622"><a href="#cb39-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-623"><a href="#cb39-623" aria-hidden="true" tabindex="-1"></a>**Light**</span>
<span id="cb39-624"><a href="#cb39-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-625"><a href="#cb39-625" aria-hidden="true" tabindex="-1"></a>PAR inside the lab conditions was essentially zero (no light for photosynthesis) across the entirety of each incubation. This is important for us to know to be able to discuss and interpret the gene ontology results from our differential expression analysis (Which genes responded to leachate treatments, and what they do, in the context that photosynthesis of the *Symbiodiniaceae* cells already in the *M. cap* embryos were not photosynthesizing and therefore likey not transferring photosynthates to embryos for metabolic processing.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This page is built using <a href="https://quarto.org/">Quarto</a>❤️ and many pages and posts are under active development</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>