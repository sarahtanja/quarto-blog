---
title: "The RNA Inhibitors"
subtitle: "A tragic saga of continued troubles"
author: "Sarah Tanja"
date: '08/22/2023'
categories: [lab records]
draft: false
toc: true
toc-title: Contents <i class="bi bi-bookmark-heart"></i>
toc-depth: 5
toc-location: left
bibliography: references.bib
reference-location: margin
citation-location: margin
quarto:
  package_options:
    cran: "https://cran.rstudio.com/"
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  message=FALSE,
  warning=FALSE,
  include=TRUE,
  cache=TRUE,
  echo=FALSE
  )
```

```{r, include=FALSE}
#install.packages("data.table")
#install.packages("dplyr")
#install.packages("formattable")
#install.packages("tidyverse")
```

## So your samples failed library prep ... ðŸ˜°

After shipping 20 samples to the University of Texas at Austin GSAF for TagSeq on June 7th 2023, I got a message back from them on June 28th 2023:

> "Your samples failed in library prep. All 20 of them, the other samples on the 96 well plate as well as our positive control all worked great. We seen this before and it is almost always an indication that there are some type of inhibitors in your samples and it impacted the prep. Based on the quality of the RNA there is nothing more we can do for them, they will not work in the prep until they have been purified, I am not sure how they were cleaned up after the extraction but it needs to be more rigorous and be certain there are no contaminants in the RNA."

After initial panic and frustration ðŸ˜¨ðŸ˜­... I started researching reverse transcriptase[^1] inhibitors and reaching out to the [Roberts](https://robertslab.github.io/resources/) and [Putnam](http://putnamlab.com/) Labs to ask for advice (recorded in this Roberts Lab [github issue](https://github.com/RobertsLab/resources/issues/1670)).

[^1]: Reverse transcriptase is an enzyme that transcribes single-stranded RNA into complementary DNA (cDNA) during library prep for RNA sequencing. It was discovered in the 1970's by David Baltimore and Howard Temin when studying retroviruses (checkout this [YouTube video](https://www.youtube.com/watch?app=desktop&v=v9EL8V-6la4) for a brief history on reverse transcriptase, and this [YouTube video](https://www.youtube.com/watch?v=POEDYHKyYDk) for a brief explanation of how it is used to turn mRNA to cDNA).

So what did I find, and what does this mean for my samples?

The RNA quantity, measured by Qubit Fluorometer, is good. And the RNA quality, measured by UT GSAF Bioanalyzer, is also good. The issue is that there is *something else* in the sample that is preventing the reverse transcriptase from generating the cDNA.

## Assessing Purity

Nanodrop purity targets[^2]:

[^2]: Check out [Assessing RNA quantity and purity with Nanodrop](https://toptipbio.com/the-nanodrop-results-explained/) by TopTipBio

-   260/280 (protein purity) **1.80 - 2.00**

-   260/230 (salts purity) **2.00 - 2.20**

#### âš ï¸ Phenol Contamination may manifest in a 260/280 ratio greater than 2.00 !

> "**A 260/280 ratio greater than 2.0 does NOT indicate the presence of especially high quality DNA, it most often reflects residual contaminants, such as phenol.**" -[@zotero-2042]
>
> " ... samples with purity ratios that range from 1.8 to 2.0 are typically considered pure. **Although purity ratios are very useful and informative, they do not always provide a complete picture of sample purity.**"
>
> "Residual chemicals from nucleic acid extraction processes (such as **guanidine salts or phenol**) or cell components that co-extract with the nucleic acids (such as protein) **can** **artificially inflate the A260 value**."

## Zymo OneStep PCR Inhibitor Removal Kit

I first tried purifying sample RNA using the [Zymo OneStep PCR Inhibitor Removal Kit](https://www.zymoresearch.com/collections/onestep-pcr-inhibitor-removal-kits) on a subset of the samples.

```{r include packages}
library(data.table)
library(dplyr)
library(formattable)
library(tidyverse)
```

```{r load in data}
nanodrop18AUG <- read_csv("nanodrop_18AUG23.csv")
```

```{r custom colors}
customGreen0 = "#DeF7E9"
customGreen = "#71CA97"
customRed = "#ff7f7f"
customOrange = "#fda172"
```

```{r formattable functions}
salts <- formatter("span",
  style = x ~ style("font-weight" = ifelse(x > 2.0, "bold", NA),
                    "background-color" = ifelse(x > 2.2, customGreen0,
                                                ifelse(x >= 2.0 & x <= 2.2, customGreen,
                                                       ifelse(x < 2.0, customRed, "inherit")))
                    ))

proteins <- formatter("span",
  style = x ~ style("font-weight" = ifelse(x > 1.8, "bold", NA),
                    "background-color" = ifelse(x > 2.0, customGreen0,
                                                ifelse(x >= 1.8 & x <= 2.0, customGreen,
                                                       ifelse(x < 1.8, customRed, "inherit")))
                    ))

```

I followed the kit instructions, and assessed the samples for purity using a Nanodrop.

![Nanodrop plot results](nanodrop_plot_03AUG23.jpg)

:   *RNA Nanodrop absorbance plot after passing Zymo DNA/RNA Quick Miniprep Plus extracted RNA samples through the Zymo OneStep PCR Inhibitor Kit. Run 03AUG2023.*

```{r}
onestep <- nanodrop18AUG %>% 
  filter(kit == 'OneStepPCRInhibitor') %>% 
  arrange(`sample-ID`)

formattable(onestep,
              align = "l",
              list(
                '260-230'= salts,
                '260-280' = proteins)
                )
```

::: {.callout-warning appearance="simple"}
Even after running samples through the Zymo OneStep PCR Inhibitor Removal Kit, The 260/230 ratios are all below the target of 2.0, indicating contamination by salts. Any 260/280 protein ratios OVER 2.0 may indicate contamination by phenols, which absorb between 280-300nm wavelengths. So... be suspicious when you see at 260/280 ratio higher than 2.0!
:::

The Zymo rep responded with the following advice:

> "The guanidine salts in our DNA/RNA Shield and DNA/RNA Lysis Buffer could be the reason of increased A230. We see this happening most often when small impurities (e.g., cell debris, protein aggregation) were transferred from sample processing and got stuck on the column. They would absorb buffers and release them during elution. Ways to avoid this include increasing the amount of DNA/RNA Shield used during processing, reducing sample input, and transferring only a fraction of sample (e.g.,500 Âµl from 800 Âµl) from the BashingBead tube to avoid debris. You can also further purify your existing eluted samples with either the RNA Clean & Concentrator that is on the way to you, or by following the "Liquids/Reaction Clean-up" procedure included in the Appendices section Quick-DNA/RNA Miniprep Plus's protocol."

------------------------------------------------------------------------

## Zymo RNA Clean & Concentrator Kit

I next tried to purify the RNA with the Zymo RNA Clean & Concentrator Kit:

![Nanodrop plot results](18aug23_drop_plot.jpg)

:   *RNA Nanodrop absorbance plot after passing Zymo DNA/RNA Quick Miniprep Plus extracted RNA samples through the Zymo RNA Clean & Concentrator Kit. Run 18AUG2023.*

```{r}
rnaCC <- nanodrop18AUG %>% 
          filter(kit == 'RNAClean&Concentrate')

formattable(rnaCC, 
              align = "l", # aligns text to the left
              list(
                '260-230'= salts,
                '260-280' = proteins)
                )
```

::: column-margin
P.S. I made these pretty tables based off [this article by Little Miss Data](https://www.littlemissdata.com/blog/prettytables)
:::

::: {.callout-warning appearance="simple"}
The 260/280 ratios over 2.0 may indicate worse phenol contamination!
:::

### Did the RNA Clean & Concentrate Kit improve the samples that had already been through the OneStep PCR Inhibitor Removal Kit?

```{r}
#| column: margin
#| fig-cap: "Nanodrop Results from OneStep PCR Inhibitor Removal"
#| cap-location: margin
formattable(onestep,
              align = "l",
              list(
                '260-230'= salts,
                '260-280' = proteins)
                )
```

```{r}
#| fig-cap: Nanodrop Results from RNA Clean & Concentrate
onesamples <- onestep$`sample-ID`

compare <- nanodrop18AUG %>% 
  filter(kit == 'RNAClean&Concentrate') %>% 
  filter(`sample-ID` %in% onesamples) %>% 
  arrange(`sample-ID`)

formattable(compare, 
              align = "l", # aligns text to the left
              list(
                '260-230'= salts,
                '260-280' = proteins)
                )
```

::: {.callout-tip appearance="simple"}
The RNA Clean & Concentrator improved the 260/230 ratios for samples 1Ea, 1CH2a, 1CA2a. 1PA2a & 1PH1a which had already been passed through the Zymo OneStep PCR Inhibitor Removal Kit.
:::

::: {.callout-warning appearance="simple"}
However, the 260/280 ratios are suspiciously high, making me question if phenol contamination has been made worse!
:::

---
## RNA Clean & Concentrator wins

```{r}
nanodrop24AUG <- read_csv("nanodrop_24AUG23.csv")

formattable(nanodrop24AUG, 
              align = "l", # aligns text to the left
              list(
                '260-230'= salts,
                '260-280' = proteins)
                )
```



